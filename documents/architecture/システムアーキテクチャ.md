# ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

**æœ€çµ‚æ›´æ–°**: 2025-12-31

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  ãƒ¦ãƒ¼ã‚¶ãƒ¼å´    â”‚              â”‚  ç®¡ç†è€…å´      â”‚         â”‚
â”‚  â”‚  Webã‚¢ãƒ—ãƒª     â”‚              â”‚  ç®¡ç†ç”»é¢      â”‚         â”‚
â”‚  â”‚  (React)       â”‚              â”‚  (React)       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ HTTPS
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Vercel (Hosting)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            Next.js 16 (App Router)                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  SSR/SSG       â”‚         â”‚  API Routes    â”‚      â”‚   â”‚
â”‚  â”‚  â”‚  Pages         â”‚         â”‚  (/api/*)      â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â”‚                                     â”‚                â”‚   â”‚
â”‚  â”‚                                     â”‚                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚         Server Components                  â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  - ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ                           â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯                         â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ Prisma Client
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Supabase (Backend as a Service)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚             PostgreSQL Database                       â”‚   â”‚
â”‚  â”‚  - restaurant_users                                   â”‚   â”‚
â”‚  â”‚  - restaurant_staff                                   â”‚   â”‚
â”‚  â”‚  - restaurant_menus                                   â”‚   â”‚
â”‚  â”‚  - restaurant_reservations                            â”‚   â”‚
â”‚  â”‚  - restaurant_settings                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚             Supabase Auth                             â”‚   â”‚
â”‚  â”‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼                                        â”‚   â”‚
â”‚  â”‚  - ãƒ¡ãƒ¼ãƒ«èªè¨¼                                          â”‚   â”‚
â”‚  â”‚  - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ

### 1. ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆPresentation Layerï¼‰

**è²¬å‹™**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³

**æŠ€è¡“**:
- Next.js App Router
- React 19
- Tailwind CSS v4

**æ§‹æˆè¦ç´ **:
```
src/app/
â”œâ”€â”€ (public)/              # æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ page.tsx          # ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ login/            # ãƒ­ã‚°ã‚¤ãƒ³
â”‚   â””â”€â”€ register/         # æ–°è¦ç™»éŒ²
â”œâ”€â”€ (user)/               # èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ booking/          # äºˆç´„æ©Ÿèƒ½
â”‚   â””â”€â”€ mypage/           # ãƒã‚¤ãƒšãƒ¼ã‚¸
â””â”€â”€ (admin)/              # ç®¡ç†è€…å‘ã‘ãƒšãƒ¼ã‚¸
    â”œâ”€â”€ dashboard/        # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    â”œâ”€â”€ reservations/     # äºˆç´„ç®¡ç†
    â”œâ”€â”€ customers/        # é¡§å®¢ç®¡ç†
    â”œâ”€â”€ staff/            # ã‚¹ã‚¿ãƒƒãƒ•ç®¡ç†
    â””â”€â”€ settings/         # åº—èˆ—è¨­å®š
```

**ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ**:
```
src/components/
â”œâ”€â”€ ui/                   # æ±ç”¨UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”œâ”€â”€ Input.tsx
â”‚   â””â”€â”€ Modal.tsx
â””â”€â”€ features/             # æ©Ÿèƒ½åˆ¥ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
    â”œâ”€â”€ booking/
    â”‚   â”œâ”€â”€ BookingCalendar.tsx
    â”‚   â”œâ”€â”€ MenuSelector.tsx
    â”‚   â””â”€â”€ StaffSelector.tsx
    â”œâ”€â”€ reservation/
    â”‚   â”œâ”€â”€ ReservationCard.tsx
    â”‚   â””â”€â”€ ReservationList.tsx
    â””â”€â”€ admin/
        â”œâ”€â”€ Dashboard.tsx
        â””â”€â”€ Sidebar.tsx
```

---

### 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆApplication Layerï¼‰

**è²¬å‹™**: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€APIå‡¦ç†ã€ãƒ‡ãƒ¼ã‚¿å¤‰æ›

**æŠ€è¡“**:
- Next.js API Routes
- Server Components
- Prisma Client

**æ§‹æˆè¦ç´ **:
```
src/app/api/
â”œâ”€â”€ auth/                 # èªè¨¼API
â”‚   â”œâ”€â”€ register/
â”‚   â”œâ”€â”€ login/
â”‚   â””â”€â”€ logout/
â”œâ”€â”€ reservations/         # äºˆç´„API
â”‚   â”œâ”€â”€ route.ts         # äºˆç´„ä¸€è¦§ãƒ»ä½œæˆ
â”‚   â””â”€â”€ [id]/            # äºˆç´„è©³ç´°ãƒ»æ›´æ–°ãƒ»å‰Šé™¤
â”œâ”€â”€ menus/               # ãƒ¡ãƒ‹ãƒ¥ãƒ¼API
â”œâ”€â”€ staff/               # ã‚¹ã‚¿ãƒƒãƒ•API
â””â”€â”€ settings/            # è¨­å®šAPI
```

**Server Actionsï¼ˆå°†æ¥çš„ã«å°å…¥ï¼‰**:
```typescript
// src/app/actions/reservations.ts
'use server'

export async function createReservation(data: CreateReservationInput) {
  // ã‚µãƒ¼ãƒãƒ¼å´ã§ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  const validated = createReservationSchema.parse(data);

  // Prismaã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ
  const reservation = await prisma.restaurantReservation.create({
    data: validated,
  });

  // ãƒ¡ãƒ¼ãƒ«é€ä¿¡ãªã©ã®å‰¯ä½œç”¨
  await sendConfirmationEmail(reservation);

  return reservation;
}
```

---

### 3. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ï¼ˆData Access Layerï¼‰

**è²¬å‹™**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã€å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€šä¿¡

**æŠ€è¡“**:
- Prisma ORM
- Supabase Client

**æ§‹æˆè¦ç´ **:
```
src/lib/
â”œâ”€â”€ prisma.ts            # Prisma Clientã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ client.ts        # Supabase Clientã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
â”‚   â””â”€â”€ auth.ts          # èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼
â””â”€â”€ utils/
    â”œâ”€â”€ date.ts          # æ—¥ä»˜æ“ä½œ
    â””â”€â”€ validation.ts    # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
```

**Prisma Clientã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³**:
```typescript
// src/lib/prisma.ts
import { PrismaClient } from '@prisma/client';

const globalForPrisma = global as unknown as { prisma: PrismaClient };

export const prisma =
  globalForPrisma.prisma ||
  new PrismaClient({
    log: ['query', 'error', 'warn'],
  });

if (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;
```

---

## ğŸ”’ èªè¨¼ãƒ»èªå¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### èªè¨¼ãƒ•ãƒ­ãƒ¼

```
ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã€‘
1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ â†’ API: POST /api/auth/register
2. API â†’ Supabase Auth: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
3. Supabase Auth â†’ ãƒ¡ãƒ¼ãƒ«: ç¢ºèªãƒªãƒ³ã‚¯é€ä¿¡
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ â†’ ãƒ¡ãƒ¼ãƒ«ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯
5. Supabase Auth: ãƒ¡ãƒ¼ãƒ«ç¢ºèªå®Œäº†
6. API â†’ Prisma: RestaurantUserãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ

ã€ãƒ­ã‚°ã‚¤ãƒ³ã€‘
1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ â†’ API: POST /api/auth/login
2. API â†’ Supabase Auth: èªè¨¼
3. Supabase Auth â†’ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: JWTç™ºè¡Œ
4. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: Cookieã«ä¿å­˜

ã€èªå¯ãƒã‚§ãƒƒã‚¯ã€‘
1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ â†’ API: ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆCookieä»˜ãï¼‰
2. API: JWTã‚’æ¤œè¨¼
3. API â†’ Prisma: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
4. API: ãƒ†ãƒŠãƒ³ãƒˆIDã€æ¨©é™ã‚’ãƒã‚§ãƒƒã‚¯
5. API â†’ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ: ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```

### ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¨­è¨ˆ

```typescript
// src/middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  const token = request.cookies.get('token');

  // æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’/loginã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
  if (!token && request.nextUrl.pathname.startsWith('/mypage')) {
    return NextResponse.redirect(new URL('/login', request.url));
  }

  // ç®¡ç†è€…æ¨©é™ãƒã‚§ãƒƒã‚¯
  if (request.nextUrl.pathname.startsWith('/admin')) {
    // ç®¡ç†è€…æ¨©é™ã‚’æ¤œè¨¼
    // ...
  }

  return NextResponse.next();
}

export const config = {
  matcher: ['/mypage/:path*', '/admin/:path*'],
};
```

---

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### äºˆç´„ä½œæˆãƒ•ãƒ­ãƒ¼

```
ã€1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BookingPage.tsx                     â”‚
â”‚  â”œâ”€ BookingCalendar                â”‚
â”‚  â”œâ”€ MenuSelector                   â”‚
â”‚  â”œâ”€ StaffSelector                  â”‚
â”‚  â””â”€ ConfirmButton                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Submit
            â–¼
ã€2. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ createReservationSchema (Zod)      â”‚
â”‚  - menuId: UUID                    â”‚
â”‚  - staffId: UUID                   â”‚
â”‚  - reservedDate: Date              â”‚
â”‚  - reservedTime: HH:MM             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ POST /api/reservations
            â–¼
ã€3. API Routeã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ /api/reservations/route.ts         â”‚
â”‚  1. ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£å–å¾—           â”‚
â”‚  2. Zodãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³              â”‚
â”‚  3. é‡è¤‡ãƒã‚§ãƒƒã‚¯                   â”‚
â”‚  4. Prismaã§ãƒ¬ã‚³ãƒ¼ãƒ‰ä½œæˆ           â”‚
â”‚  5. ãƒ¡ãƒ¼ãƒ«é€ä¿¡                     â”‚
â”‚  6. ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Prisma Client
            â–¼
ã€4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase PostgreSQL                â”‚
â”‚  - restaurant_reservations         â”‚
â”‚    INSERT INTO ...                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ SUCCESS
            â–¼
ã€5. ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã€‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Email Service (Resend / SendGrid)  â”‚
â”‚  - äºˆç´„ç¢ºèªãƒ¡ãƒ¼ãƒ«                   â”‚
â”‚  - To: customer@example.com        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š çŠ¶æ…‹ç®¡ç†ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†

**ä½¿ç”¨ãƒ„ãƒ¼ãƒ«**:
- React Context APIï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ï¼‰
- TanStack Queryï¼ˆã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ï¼‰
- React Hook Formï¼ˆãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹ï¼‰

**çŠ¶æ…‹ã®ç¨®é¡**:

| çŠ¶æ…‹ã®ç¨®é¡ | ç®¡ç†æ–¹æ³• | ä¾‹ |
|----------|---------|---|
| **UIãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹** | `useState` | ãƒ¢ãƒ¼ãƒ€ãƒ«ã®é–‹é–‰ã€å…¥åŠ›å€¤ |
| **ã‚°ãƒ­ãƒ¼ãƒãƒ«UIçŠ¶æ…‹** | Context API | ãƒ†ãƒ¼ãƒã€è¨€èªè¨­å®š |
| **ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹** | TanStack Query | äºˆç´„ä¸€è¦§ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä¸€è¦§ |
| **ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹** | React Hook Form | äºˆç´„ãƒ•ã‚©ãƒ¼ãƒ ã€ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ  |

**TanStack Queryè¨­å®š**:
```typescript
// src/lib/query-client.ts
import { QueryClient } from '@tanstack/react-query';

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 60 * 1000, // 1åˆ†
      cacheTime: 5 * 60 * 1000, // 5åˆ†
      refetchOnWindowFocus: false,
      retry: 1,
    },
  },
});
```

---

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

| è„…å¨ | å¯¾ç­– |
|-----|------|
| **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³** | Prisma ORMã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒª |
| **XSS** | Reactã®è‡ªå‹•ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã€DOMPurify |
| **CSRF** | Next.jsã®SameSite Cookieã€CSRFãƒˆãƒ¼ã‚¯ãƒ³ |
| **èªè¨¼ã®è„†å¼±æ€§** | Supabase Authï¼ˆæ¥­ç•Œæ¨™æº–ï¼‰ |
| **æ©Ÿå¯†æƒ…å ±æ¼æ´©** | ç’°å¢ƒå¤‰æ•°ç®¡ç†ã€.gitignore |
| **æ¨©é™æ˜‡æ ¼** | ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ã®æ¨©é™ãƒã‚§ãƒƒã‚¯ |

### ç’°å¢ƒå¤‰æ•°ç®¡ç†

```bash
# .env.localï¼ˆgitignoreã«å«ã‚ã‚‹ï¼‰
DATABASE_URL="postgresql://..."
NEXT_PUBLIC_SUPABASE_URL="..."
NEXT_PUBLIC_SUPABASE_ANON_KEY="..."
SUPABASE_SERVICE_ROLE_KEY="..."
NEXT_PUBLIC_TENANT_ID="demo-restaurant"
```

---

## ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### æœ€é©åŒ–æˆ¦ç•¥

1. **ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆSSRï¼‰**
   - åˆå›ãƒ­ãƒ¼ãƒ‰ã®é«˜é€ŸåŒ–
   - SEOå¯¾ç­–

2. **é™çš„ã‚µã‚¤ãƒˆç”Ÿæˆï¼ˆSSGï¼‰**
   - ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãªã©é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
   - ãƒ“ãƒ«ãƒ‰æ™‚ã«ç”Ÿæˆ

3. **ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°**
   - TanStack Queryã§ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥
   - Next.jsã®ISRï¼ˆIncremental Static Regenerationï¼‰

4. **ã‚³ãƒ¼ãƒ‰åˆ†å‰²**
   - Dynamic Import
   - Route-based Code Splitting

5. **ç”»åƒæœ€é©åŒ–**
   - Next.js Imageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
   - WebPå½¢å¼

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™

| æŒ‡æ¨™ | ç›®æ¨™å€¤ |
|-----|-------|
| **First Contentful Paint (FCP)** | < 1.5ç§’ |
| **Time to Interactive (TTI)** | < 3ç§’ |
| **Lighthouse Performance** | > 90 |
| **Lighthouse Accessibility** | > 95 |

---

## ğŸ“ˆ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£è¨­è¨ˆ

### æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°

- **Vercel**: è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°å¯¾å¿œ
- **Supabase**: ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã§è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°

### å°†æ¥çš„ãªæ‹¡å¼µ

1. **Rediså°å…¥**
   - ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥
   - APIãƒ¬ãƒ¼ãƒˆåˆ¶é™

2. **CDNæœ€é©åŒ–**
   - Vercel Edge Network

3. **ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–**
   - ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒ¼ãƒ«é€ä¿¡
   - åˆ†æãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

4. **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–**
   - å¿…è¦ã«å¿œã˜ã¦æ©Ÿèƒ½ã‚’åˆ†é›¢

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

```
        /\
       /E2E\         E2Eãƒ†ã‚¹ãƒˆï¼ˆ10%ï¼‰
      /------\       - Playwright
     /Integration\   çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ30%ï¼‰
    /------------\   - React Testing Library
   /  Unit Tests  \  å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆ60%ï¼‰
  /----------------\ - Jest
```

### ãƒ†ã‚¹ãƒˆã®è²¬å‹™åˆ†é›¢

| ãƒ†ã‚¹ãƒˆç¨®åˆ¥ | è²¬å‹™ | ä¾‹ |
|----------|------|---|
| **E2E** | ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼å…¨ä½“ | ãƒ­ã‚°ã‚¤ãƒ³ â†’ äºˆç´„ â†’ å®Œäº† |
| **çµ±åˆ** | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“é€£æº | BookingPageå…¨ä½“ |
| **å˜ä½“** | é–¢æ•°ãƒ»ãƒ­ã‚¸ãƒƒã‚¯ | æ—¥ä»˜ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `spec/ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸.md` - DBè¨­è¨ˆè©³ç´°
- `api/APIè¨­è¨ˆæ›¸.md` - APIä»•æ§˜
- `architecture/ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆè¨­è¨ˆ.md` - ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢è¨­è¨ˆ
- `development/é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹è¨­è¨ˆ.md` - é–‹ç™ºãƒ•ãƒ­ãƒ¼
- `testing/ãƒ†ã‚¹ãƒˆæˆ¦ç•¥.md` - ãƒ†ã‚¹ãƒˆè©³ç´°

---

## ğŸ”„ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®é€²åŒ–

### ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚º: MVPï¼ˆMinimum Viable Productï¼‰
- ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆ
- é«˜é€Ÿãªé–‹ç™º

### å°†æ¥ã®ãƒ•ã‚§ãƒ¼ã‚º: ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã®æ¤œè¨
- ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- CQRSï¼ˆCommand Query Responsibility Segregationï¼‰

---

**ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€å®Ÿç”¨æ€§ã€ä¿å®ˆæ€§ã€æ‹¡å¼µæ€§ã‚’é‡è¦–ã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚**
