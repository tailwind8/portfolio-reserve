# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ›¸

**æœ€çµ‚æ›´æ–°**: 2025-12-31
**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: Supabase PostgreSQL
**ORM**: Prisma 7

---

## ğŸ“Š ERå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ restaurant_users    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚
â”‚ tenant_id          â”‚
â”‚ auth_id (UK)       â”‚
â”‚ email              â”‚
â”‚ name               â”‚
â”‚ phone              â”‚
â”‚ created_at         â”‚
â”‚ updated_at         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1
         â”‚
         â”‚ *
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ restaurant_         â”‚   *   â”‚ restaurant_menus    â”‚
â”‚ reservations        â”‚â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚       â”‚ id (PK)            â”‚
â”‚ tenant_id          â”‚       â”‚ tenant_id          â”‚
â”‚ user_id (FK)       â”‚       â”‚ name               â”‚
â”‚ staff_id (FK)      â”‚       â”‚ description        â”‚
â”‚ menu_id (FK)       â”‚       â”‚ price              â”‚
â”‚ reserved_date      â”‚       â”‚ duration           â”‚
â”‚ reserved_time      â”‚       â”‚ is_active          â”‚
â”‚ status             â”‚       â”‚ category           â”‚
â”‚ notes              â”‚       â”‚ created_at         â”‚
â”‚ created_at         â”‚       â”‚ updated_at         â”‚
â”‚ updated_at         â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ *
         â”‚
         â”‚ 1
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ restaurant_staff    â”‚       â”‚ restaurant_settings â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)            â”‚       â”‚ id (PK)            â”‚
â”‚ tenant_id          â”‚       â”‚ tenant_id (UK)     â”‚
â”‚ name               â”‚       â”‚ store_name         â”‚
â”‚ role               â”‚       â”‚ store_email        â”‚
â”‚ is_active          â”‚       â”‚ store_phone        â”‚
â”‚ created_at         â”‚       â”‚ open_time          â”‚
â”‚ updated_at         â”‚       â”‚ close_time         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ closed_days        â”‚
                              â”‚ slot_duration      â”‚
                              â”‚ created_at         â”‚
                              â”‚ updated_at         â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©

### 1. restaurant_usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

**ç›®çš„**: äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ©ç”¨ã™ã‚‹é¡§å®¢ã®æƒ…å ±ã‚’ç®¡ç†

| ã‚«ãƒ©ãƒ å | å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---|------|-----------|------|
| `id` | UUID | NO | uuid() | ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ |
| `tenant_id` | VARCHAR | NO | 'demo-restaurant' | ãƒ†ãƒŠãƒ³ãƒˆIDï¼ˆãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œï¼‰ |
| `auth_id` | UUID | YES | NULL | Supabase Auth UUID |
| `email` | VARCHAR | NO | - | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| `name` | VARCHAR | YES | NULL | æ°å |
| `phone` | VARCHAR | YES | NULL | é›»è©±ç•ªå· |
| `created_at` | TIMESTAMP | NO | now() | ä½œæˆæ—¥æ™‚ |
| `updated_at` | TIMESTAMP | NO | now() | æ›´æ–°æ—¥æ™‚ |

**åˆ¶ç´„**:
- PRIMARY KEY: `id`
- UNIQUE: `(tenant_id, email)` - åŒä¸€ãƒ†ãƒŠãƒ³ãƒˆå†…ã§ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ä¸€æ„
- UNIQUE: `auth_id` - Supabase Auth IDã¯ä¸€æ„
- INDEX: `tenant_id` - ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ã‚¯ã‚¨ãƒªã®é«˜é€ŸåŒ–

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:
- `restaurant_reservations.user_id` â†’ `restaurant_users.id` (1:N)

---

### 2. restaurant_staffï¼ˆã‚¹ã‚¿ãƒƒãƒ•ï¼‰

**ç›®çš„**: åº—èˆ—ã®ã‚¹ã‚¿ãƒƒãƒ•æƒ…å ±ã‚’ç®¡ç†

| ã‚«ãƒ©ãƒ å | å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---|------|-----------|------|
| `id` | UUID | NO | uuid() | ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ |
| `tenant_id` | VARCHAR | NO | 'demo-restaurant' | ãƒ†ãƒŠãƒ³ãƒˆID |
| `name` | VARCHAR | NO | - | ã‚¹ã‚¿ãƒƒãƒ•å |
| `role` | VARCHAR | YES | NULL | å½¹è·ï¼ˆä¾‹: ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆï¼‰ |
| `is_active` | BOOLEAN | NO | true | æœ‰åŠ¹/ç„¡åŠ¹ãƒ•ãƒ©ã‚° |
| `created_at` | TIMESTAMP | NO | now() | ä½œæˆæ—¥æ™‚ |
| `updated_at` | TIMESTAMP | NO | now() | æ›´æ–°æ—¥æ™‚ |

**åˆ¶ç´„**:
- PRIMARY KEY: `id`
- INDEX: `tenant_id`

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:
- `restaurant_reservations.staff_id` â†’ `restaurant_staff.id` (1:N)

---

### 3. restaurant_menusï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰

**ç›®çš„**: ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®æƒ…å ±ã‚’ç®¡ç†

| ã‚«ãƒ©ãƒ å | å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---|------|-----------|------|
| `id` | UUID | NO | uuid() | ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ |
| `tenant_id` | VARCHAR | NO | 'demo-restaurant' | ãƒ†ãƒŠãƒ³ãƒˆID |
| `name` | VARCHAR | NO | - | ãƒ¡ãƒ‹ãƒ¥ãƒ¼å |
| `description` | TEXT | YES | NULL | èª¬æ˜ |
| `price` | INTEGER | NO | - | ä¾¡æ ¼ï¼ˆå††ï¼‰ |
| `duration` | INTEGER | NO | - | æ‰€è¦æ™‚é–“ï¼ˆåˆ†ï¼‰ |
| `is_active` | BOOLEAN | NO | true | æœ‰åŠ¹/ç„¡åŠ¹ãƒ•ãƒ©ã‚° |
| `category` | VARCHAR | YES | NULL | ã‚«ãƒ†ã‚´ãƒªï¼ˆä¾‹: ã‚«ãƒƒãƒˆã€ã‚«ãƒ©ãƒ¼ï¼‰ |
| `created_at` | TIMESTAMP | NO | now() | ä½œæˆæ—¥æ™‚ |
| `updated_at` | TIMESTAMP | NO | now() | æ›´æ–°æ—¥æ™‚ |

**åˆ¶ç´„**:
- PRIMARY KEY: `id`
- INDEX: `tenant_id`

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:
- `restaurant_reservations.menu_id` â†’ `restaurant_menus.id` (1:N)

---

### 4. restaurant_reservationsï¼ˆäºˆç´„ï¼‰

**ç›®çš„**: äºˆç´„æƒ…å ±ã‚’ç®¡ç†ï¼ˆã‚·ã‚¹ãƒ†ãƒ ã®ã‚³ã‚¢ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

| ã‚«ãƒ©ãƒ å | å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---|------|-----------|------|
| `id` | UUID | NO | uuid() | ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ |
| `tenant_id` | VARCHAR | NO | 'demo-restaurant' | ãƒ†ãƒŠãƒ³ãƒˆID |
| `user_id` | UUID | NO | - | ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆFKï¼‰ |
| `staff_id` | UUID | NO | - | ã‚¹ã‚¿ãƒƒãƒ•IDï¼ˆFKï¼‰ |
| `menu_id` | UUID | NO | - | ãƒ¡ãƒ‹ãƒ¥ãƒ¼IDï¼ˆFKï¼‰ |
| `reserved_date` | DATE | NO | - | äºˆç´„æ—¥ |
| `reserved_time` | VARCHAR | NO | - | äºˆç´„æ™‚é–“ï¼ˆä¾‹: "14:00"ï¼‰ |
| `status` | ENUM | NO | PENDING | äºˆç´„ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
| `notes` | TEXT | YES | NULL | å‚™è€ƒãƒ»è¦æœ› |
| `created_at` | TIMESTAMP | NO | now() | ä½œæˆæ—¥æ™‚ |
| `updated_at` | TIMESTAMP | NO | now() | æ›´æ–°æ—¥æ™‚ |

**åˆ¶ç´„**:
- PRIMARY KEY: `id`
- FOREIGN KEY: `user_id` â†’ `restaurant_users.id` (CASCADE DELETE)
- FOREIGN KEY: `staff_id` â†’ `restaurant_staff.id`
- FOREIGN KEY: `menu_id` â†’ `restaurant_menus.id`
- INDEX: `tenant_id`
- INDEX: `user_id`
- INDEX: `reserved_date`

**ENUM: ReservationStatus**
- `PENDING` - äºˆç´„ç¢ºå®šå¾…ã¡
- `CONFIRMED` - ç¢ºå®š
- `CANCELLED` - ã‚­ãƒ£ãƒ³ã‚»ãƒ«
- `COMPLETED` - å®Œäº†ï¼ˆæ¥åº—æ¸ˆã¿ï¼‰
- `NO_SHOW` - ç„¡æ–­ã‚­ãƒ£ãƒ³ã‚»ãƒ«

**ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:
- `user_id` â†’ `restaurant_users.id` (N:1)
- `staff_id` â†’ `restaurant_staff.id` (N:1)
- `menu_id` â†’ `restaurant_menus.id` (N:1)

---

### 5. restaurant_settingsï¼ˆåº—èˆ—è¨­å®šï¼‰

**ç›®çš„**: åº—èˆ—ã®åŸºæœ¬æƒ…å ±ã¨å–¶æ¥­è¨­å®šã‚’ç®¡ç†

| ã‚«ãƒ©ãƒ å | å‹ | NULL | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|---------|---|------|-----------|------|
| `id` | UUID | NO | uuid() | ãƒ—ãƒ©ã‚¤ãƒãƒªã‚­ãƒ¼ |
| `tenant_id` | VARCHAR | NO | 'demo-restaurant' | ãƒ†ãƒŠãƒ³ãƒˆID |
| `store_name` | VARCHAR | NO | - | åº—èˆ—å |
| `store_email` | VARCHAR | YES | NULL | åº—èˆ—ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ |
| `store_phone` | VARCHAR | YES | NULL | åº—èˆ—é›»è©±ç•ªå· |
| `open_time` | VARCHAR | NO | '09:00' | é–‹åº—æ™‚åˆ» |
| `close_time` | VARCHAR | NO | '20:00' | é–‰åº—æ™‚åˆ» |
| `closed_days` | VARCHAR[] | NO | [] | å®šä¼‘æ—¥ï¼ˆä¾‹: ["Sunday"]ï¼‰ |
| `slot_duration` | INTEGER | NO | 30 | äºˆç´„æ ã®é–“éš”ï¼ˆåˆ†ï¼‰ |
| `created_at` | TIMESTAMP | NO | now() | ä½œæˆæ—¥æ™‚ |
| `updated_at` | TIMESTAMP | NO | now() | æ›´æ–°æ—¥æ™‚ |

**åˆ¶ç´„**:
- PRIMARY KEY: `id`
- UNIQUE: `tenant_id` - 1ãƒ†ãƒŠãƒ³ãƒˆ1è¨­å®š

---

## ğŸ” ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆè¨­è¨ˆ

### æ¦‚è¦
è¤‡æ•°ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§åŒä¸€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã€ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢ã‚’å®Ÿè£…

### å®Ÿè£…æ–¹é‡

#### 1. ãƒ†ãƒ¼ãƒ–ãƒ«åãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
- `restaurant_*` - äºˆç´„ã‚·ã‚¹ãƒ†ãƒ 
- `hotel_*` - ãƒ›ãƒ†ãƒ«äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå°†æ¥ï¼‰
- `clinic_*` - ã‚¯ãƒªãƒ‹ãƒƒã‚¯äºˆç´„ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå°†æ¥ï¼‰

#### 2. tenant_id ã«ã‚ˆã‚‹è«–ç†åˆ†é›¢
- å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã« `tenant_id` ã‚«ãƒ©ãƒ ã‚’é…ç½®
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤: `'demo-restaurant'`
- ã‚¯ã‚¨ãƒªæ™‚ã«å¿…ãš `tenant_id` ã§ãƒ•ã‚£ãƒ«ã‚¿

#### 3. Prismaã§ã®å®Ÿè£…ä¾‹

```typescript
// ãƒ†ãƒŠãƒ³ãƒˆIDã‚’ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—
const TENANT_ID = process.env.NEXT_PUBLIC_TENANT_ID || 'demo-restaurant';

// ã‚¯ã‚¨ãƒªæ™‚ã«å¿…ãšãƒ†ãƒŠãƒ³ãƒˆIDã§ãƒ•ã‚£ãƒ«ã‚¿
const users = await prisma.restaurantUser.findMany({
  where: {
    tenantId: TENANT_ID,
  },
});
```

#### 4. Row Level Security (RLS) ã®æ´»ç”¨ï¼ˆå°†æ¥ï¼‰

Supabase RLSã‚’ä½¿ç”¨ã—ãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–:

```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªèº«ã®ãƒ†ãƒŠãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã®ã¿é–²è¦§å¯èƒ½
CREATE POLICY tenant_isolation ON restaurant_users
  USING (tenant_id = current_setting('app.current_tenant'));
```

---

## ğŸ“ˆ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥

### ç›®çš„åˆ¥ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

| ãƒ†ãƒ¼ãƒ–ãƒ« | ã‚«ãƒ©ãƒ  | ç›®çš„ |
|---------|-------|------|
| `restaurant_users` | `tenant_id` | ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ |
| `restaurant_users` | `auth_id` | Supabase Authé€£æº |
| `restaurant_users` | `(tenant_id, email)` | ãƒ­ã‚°ã‚¤ãƒ³é«˜é€ŸåŒ– |
| `restaurant_staff` | `tenant_id` | ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ |
| `restaurant_menus` | `tenant_id` | ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ |
| `restaurant_reservations` | `tenant_id` | ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ•ã‚£ãƒ«ã‚¿ |
| `restaurant_reservations` | `user_id` | ãƒ¦ãƒ¼ã‚¶ãƒ¼äºˆç´„ä¸€è¦§ |
| `restaurant_reservations` | `reserved_date` | æ—¥ä»˜æ¤œç´¢ |

### è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ¤œè¨

```sql
-- äºˆç´„æ¤œç´¢ã®é«˜é€ŸåŒ–
CREATE INDEX idx_reservations_tenant_date
  ON restaurant_reservations(tenant_id, reserved_date);

-- ã‚¹ã‚¿ãƒƒãƒ•åˆ¥äºˆç´„æ¤œç´¢
CREATE INDEX idx_reservations_staff_date
  ON restaurant_reservations(staff_id, reserved_date);
```

---

## ğŸ”’ ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§åˆ¶ç´„

### å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„

| è¦ªãƒ†ãƒ¼ãƒ–ãƒ« | å­ãƒ†ãƒ¼ãƒ–ãƒ« | ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ |
|----------|----------|----------|
| `restaurant_users` â†’ `restaurant_reservations` | user_id | CASCADE DELETE |
| `restaurant_staff` â†’ `restaurant_reservations` | staff_id | RESTRICT |
| `restaurant_menus` â†’ `restaurant_reservations` | menu_id | RESTRICT |

**CASCADE DELETEç†ç”±**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤æ™‚ã€é–¢é€£ã™ã‚‹äºˆç´„ã‚‚å‰Šé™¤ï¼ˆGDPRå¯¾å¿œï¼‰

**RESTRICTç†ç”±**:
- ã‚¹ã‚¿ãƒƒãƒ•/ãƒ¡ãƒ‹ãƒ¥ãƒ¼å‰Šé™¤æ™‚ã€é–¢é€£äºˆç´„ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤ä¸å¯ï¼ˆãƒ‡ãƒ¼ã‚¿ä¿è­·ï¼‰

---

## ğŸ§ª ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿

### åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆSeedï¼‰

```typescript
// prisma/seed.ts
import { PrismaClient } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  const TENANT_ID = 'demo-restaurant';

  // åº—èˆ—è¨­å®š
  await prisma.restaurantSettings.create({
    data: {
      tenantId: TENANT_ID,
      storeName: 'ã‚µãƒ³ãƒ—ãƒ«ç¾å®¹å®¤',
      storeEmail: 'info@sample-salon.com',
      storePhone: '03-1234-5678',
      openTime: '10:00',
      closeTime: '20:00',
      closedDays: ['Monday'],
      slotDuration: 30,
    },
  });

  // ã‚¹ã‚¿ãƒƒãƒ•
  const staff = await prisma.restaurantStaff.createMany({
    data: [
      { tenantId: TENANT_ID, name: 'ç”°ä¸­å¤ªéƒ', role: 'ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆ' },
      { tenantId: TENANT_ID, name: 'ä½è—¤èŠ±å­', role: 'ã‚·ãƒ‹ã‚¢ã‚¹ã‚¿ã‚¤ãƒªã‚¹ãƒˆ' },
    ],
  });

  // ãƒ¡ãƒ‹ãƒ¥ãƒ¼
  const menus = await prisma.restaurantMenu.createMany({
    data: [
      { tenantId: TENANT_ID, name: 'ã‚«ãƒƒãƒˆ', price: 5000, duration: 60, category: 'ã‚«ãƒƒãƒˆ' },
      { tenantId: TENANT_ID, name: 'ã‚«ãƒ©ãƒ¼', price: 8000, duration: 90, category: 'ã‚«ãƒ©ãƒ¼' },
      { tenantId: TENANT_ID, name: 'ãƒ‘ãƒ¼ãƒ', price: 10000, duration: 120, category: 'ãƒ‘ãƒ¼ãƒ' },
    ],
  });

  console.log('Seed data inserted successfully');
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
```

---

## ğŸ“Š æƒ³å®šã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. äºˆç´„ä¸€è¦§å–å¾—ï¼ˆç®¡ç†è€…ï¼‰

```typescript
// ç‰¹å®šæ—¥ã®äºˆç´„ä¸€è¦§
const reservations = await prisma.restaurantReservation.findMany({
  where: {
    tenantId: TENANT_ID,
    reservedDate: new Date('2025-01-20'),
  },
  include: {
    user: true,
    staff: true,
    menu: true,
  },
  orderBy: {
    reservedTime: 'asc',
  },
});
```

### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®äºˆç´„å±¥æ­´å–å¾—

```typescript
const userReservations = await prisma.restaurantReservation.findMany({
  where: {
    tenantId: TENANT_ID,
    userId: 'user-uuid',
  },
  include: {
    staff: true,
    menu: true,
  },
  orderBy: {
    reservedDate: 'desc',
  },
});
```

### 3. ç©ºãæ™‚é–“æ¤œç´¢

```typescript
// ç‰¹å®šæ—¥æ™‚ã®ã‚¹ã‚¿ãƒƒãƒ•ã®äºˆç´„çŠ¶æ³ãƒã‚§ãƒƒã‚¯
const conflictingReservations = await prisma.restaurantReservation.findFirst({
  where: {
    tenantId: TENANT_ID,
    staffId: 'staff-uuid',
    reservedDate: new Date('2025-01-20'),
    reservedTime: '14:00',
    status: {
      not: 'CANCELLED',
    },
  },
});

// ç©ºã„ã¦ã„ã‚‹å ´åˆ: conflictingReservations === null
```

---

## ğŸ”„ ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥

### é–‹ç™ºç’°å¢ƒ

```bash
# ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´å¾Œ
npx prisma migrate dev --name add_new_field

# Prisma Clientå†ç”Ÿæˆ
npx prisma generate
```

### æœ¬ç•ªç’°å¢ƒ

```bash
# æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«æ¤œè¨¼ç’°å¢ƒã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç¢ºèª
npx prisma migrate deploy
```

### ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥

```bash
# ç‰¹å®šã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«æˆ»ã™
npx prisma migrate resolve --rolled-back <migration-name>
```

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `reserve-app/prisma/schema.prisma` - Prismaã‚¹ã‚­ãƒ¼ãƒå®šç¾©
- `api/APIè¨­è¨ˆæ›¸.md` - APIä»•æ§˜
- `architecture/ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£.md` - ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ
- `architecture/ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆè¨­è¨ˆ.md` - ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢è¨­è¨ˆ

---

## ğŸš€ ä»Šå¾Œã®æ‹¡å¼µäºˆå®š

### Phase 2
- ã‚«ãƒ«ãƒ†ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ï¼ˆæ–½è¡“å±¥æ­´ã€å†™çœŸï¼‰
- ã‚¯ãƒ¼ãƒãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ 

### Phase 3
- åˆ†æç”¨é›†è¨ˆãƒ†ãƒ¼ãƒ–ãƒ«
- ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼é€ä¿¡å±¥æ­´ãƒ†ãƒ¼ãƒ–ãƒ«

---

**ã“ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¯ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã¨ä¿å®ˆæ€§ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚**
