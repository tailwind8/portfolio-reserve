# 予約システム - 機能一覧とページ設計

**最終更新**: 2026-01-04

## 📋 プロジェクト概要
- **システム名**: 飲食店向け予約管理システム
- **コンセプト**: ホットペッパーより安く、店舗専用で他店に誘導されない自社予約システム
- **デザインコンセプト**: 白ベース、爽やか、汎用的（美容室・飲食店・歯科医院など多業種対応）

**実装進捗**: Phase 1 コア機能 **100%完了** ✅

---

## 🎯 必要な機能一覧

### 🔴 Phase 1: 必須機能（コア機能） - 100%完了 ✅

#### A. 認証機能 - 100%完了 ✅
- [x] ユーザー新規登録（メールアドレス + パスワード） ✅
- [ ] メール認証（確認リンク送信） ⚠️ 未実装
- [x] ログイン ✅
- [x] ログアウト ✅
- [ ] パスワードリセット ⚠️ 未実装
- [x] 管理者用別認証（店舗スタッフ用） ✅

#### B. 予約機能（ユーザー側） - 100%完了 ✅
- [x] 予約カレンダー表示（月表示・週表示切替） ✅
- [x] 空き状況のリアルタイム表示 ✅
- [x] メニュー選択（カテゴリ別表示） ✅
- [x] 担当者（スタッフ）指名選択 ✅
- [x] 日時選択 ✅
- [x] 予約内容確認画面 ✅
- [x] 予約登録 ✅
- [x] 予約確認メール自動送信 ✅
- [x] 予約変更 ✅
- [x] 予約キャンセル ✅
- [x] マイページ - 予約一覧表示 ✅
- [x] マイページ - 来店履歴表示 ✅

#### C. 管理機能（店舗側） - 100%完了 ✅
- [x] ダッシュボード ✅
  - [x] 本日の予約件数サマリー ✅
  - [x] 本日の予約一覧 ✅
  - [x] 週間予約状況 ✅
- [x] 予約管理 ✅
  - [x] カレンダー表示（日/週/月切替） ✅
  - [x] 予約一覧表示（フィルタ・ソート機能） ✅
  - [x] 予約手動追加 ✅
  - [x] 予約編集 ✅
  - [x] 予約削除 ✅
  - [x] ステータス変更（予約中/来店済み/キャンセル/無断キャンセル） ✅
- [x] 顧客管理 ✅ Issue #19, #20
  - [x] 顧客一覧表示 ✅
  - [x] 顧客詳細表示 ✅
  - [x] 来店履歴表示 ✅
  - [x] 顧客メモ機能 ✅
  - [x] 顧客情報編集 ✅
- [x] スタッフ管理 ✅
  - [x] スタッフ一覧表示 ✅
  - [x] スタッフ登録・編集・削除 ✅
  - [x] 出勤シフト設定（曜日・時間帯） ✅
  - [x] 休暇設定 ✅
- [x] メニュー管理 ✅
  - [x] メニュー一覧表示 ✅
  - [x] メニュー登録（名前、カテゴリ、料金、所要時間、説明） ✅
  - [x] メニュー編集 ✅
  - [x] メニュー削除 ✅
  - [x] カテゴリ管理 ✅
- [x] 店舗設定 ✅
  - [x] 基本情報（店舗名、電話番号、住所） ✅
  - [x] 営業時間設定 ✅
  - [x] 定休日設定 ✅
  - [x] 予約受付可能時間設定 ✅
  - [x] 予約間隔設定（30分/1時間など） ✅
  - [x] 予約受付期間設定（何日前〜何日後） ✅ Issue #79
  - [x] キャンセル期限設定 ✅ Issue #80

---

### 🟡 Phase 2: 差別化機能 - 60%完了

#### D. 自動化・通知機能 - 25%完了
- [x] リマインドメール自動送信（前日・当日） ✅ Issue #25
- [ ] キャンセル待ち機能 ⚠️
- [ ] キャンセル時の自動通知 ⚠️
- [ ] 予約確定時の店舗側通知 ⚠️

#### E. 分析・レポート機能 - 100%完了 ✅ Issue #26, #27
- [x] 分析ダッシュボード ✅
- [x] 予約件数推移グラフ（日別/週別/月別） ✅
- [x] リピート率分析 ✅
- [ ] 人気メニューランキング ⚠️ Phase 3予定
- [ ] 人気時間帯分析 ⚠️ Phase 3予定
- [ ] 売上レポート ⚠️ Phase 3予定

#### F. 顧客体験向上機能 - 0%完了
- [ ] カルテ機能（施術履歴、メモ、写真添付）
- [ ] クーポン発行機能
- [ ] クーポン適用機能
- [ ] お気に入りスタッフ登録

---

### 🟢 Phase 3: オリジナル機能（アピール度UP）

#### G. 高度な機能
- [ ] AIおすすめ予約（過去の来店パターンから最適日時提案）
- [ ] LINE通知連携
- [ ] スキマ時間ブロック（予約間のムダな空き時間を自動調整）
- [ ] 口コミ投稿機能
- [ ] 多言語対応（英語/中国語）

---

## 📱 必要なページ一覧

### 【ユーザー側】全11ページ

#### 1. 公開ページ（未認証でもアクセス可能）
| No | ページ名 | パス | 説明 | 状態 |
|----|---------|------|------|------|
| 1 | トップページ | `/` | 店舗紹介、予約ボタン | ✅ 実装済み |
| 2 | ログイン | `/login` | ユーザーログイン画面 | ✅ 実装済み |
| 3 | 新規登録 | `/register` | ユーザー新規登録画面 | ✅ 実装済み |
| 4 | メニュー一覧 | `/menus` | メニューカタログ表示 | ✅ 実装済み |
| 5 | プライバシーポリシー | `/privacy` | プライバシーポリシー | ✅ 実装済み |
| 6 | 利用規約 | `/terms` | 利用規約 | ✅ 実装済み |
| 7 | ヘルプ | `/help` | ヘルプページ | ✅ 実装済み |

#### 2. 認証後ページ
| No | ページ名 | パス | 説明 | 状態 |
|----|---------|------|------|------|
| 8 | 予約作成 | `/booking` | メニュー・日時・スタッフ選択を統合 | ✅ 実装済み |
| 9 | マイ予約 | `/my-reservations` | 予約一覧・キャンセル | ✅ 実装済み |
| 10 | マイページ | `/mypage` | 来店履歴・予約一覧 | ✅ 実装済み |
| 11 | メンテナンス | `/maintenance` | メンテナンスモード表示 | ✅ 実装済み |

> **設計変更メモ**: 予約フローは `/booking` 1ページに統合（UX改善のためステップ分割を廃止）

---

### 【管理者側（店舗側）】全11ページ

#### 3. 管理画面（ADMIN）
| No | ページ名 | パス | 説明 | 状態 |
|----|---------|------|------|------|
| 1 | 管理者ログイン | `/admin/login` | 管理者専用ログイン | ✅ 実装済み |
| 2 | ダッシュボード | `/admin/dashboard` | 本日の予約状況サマリー | ✅ 実装済み |
| 3 | 予約管理 | `/admin/reservations` | 予約カレンダー・一覧（モーダル編集） | ✅ 実装済み |
| 4 | 顧客管理 | `/admin/customers` | 顧客一覧 | ✅ 実装済み |
| 5 | 顧客詳細 | `/admin/customers/[id]` | 顧客詳細・来店履歴・メモ | ✅ 実装済み |
| 6 | スタッフ管理 | `/admin/staff` | スタッフ一覧・シフト設定 | ✅ 実装済み |
| 7 | メニュー管理 | `/admin/menus` | メニューCRUD | ✅ 実装済み |
| 8 | 予約ブロック管理 | `/admin/blocked-times` | 予約不可時間帯の設定 | ✅ 実装済み |
| 9 | 店舗設定 | `/admin/settings` | 営業時間・基本情報設定 | ✅ 実装済み |
| 10 | 分析レポート | `/admin/analytics` | 予約推移・リピート率 | ✅ 実装済み |

> **設計変更メモ**: 予約詳細編集はモーダル表示に変更（`/admin/reservations/[id]` は廃止）

### 【スーパー管理者（開発者）】全3ページ

#### 4. スーパー管理画面（SUPER_ADMIN）
| No | ページ名 | パス | 説明 | 状態 |
|----|---------|------|------|------|
| 1 | スーパー管理者ログイン | `/super-admin/login` | 開発者専用ログイン | ✅ 実装済み |
| 2 | ダッシュボード | `/super-admin/dashboard` | テナント管理概要 | ✅ 実装済み |
| 3 | 機能フラグ管理 | `/super-admin/feature-flags` | オプション機能のON/OFF | ✅ 実装済み |

> **ロール設計**: SUPER_ADMINはシステム全体を管理する開発者向け機能。詳細は `documents/spec/ロール設計書.md` 参照

---

## 🎨 デザインガイドライン

### カラーパレット（白ベース・爽やか）
- **ベース**: 白 (#FFFFFF)
- **サブベース**: 薄いグレー (#F8F9FA, #F1F3F5)
- **プライマリー**: 爽やかなブルー (#3B82F6, #60A5FA)
- **セカンダリー**: ライトグリーン (#10B981, #34D399)
- **アクセント**: オレンジ (#F59E0B)
- **テキスト**: ダークグレー (#1F2937, #4B5563)
- **ボーダー**: ライトグレー (#E5E7EB)

### デザインの方向性
- ✅ ミニマルで洗練されたデザイン
- ✅ 余白を活かしたレイアウト
- ✅ 角丸を活用した柔らかい印象
- ✅ シャドウは控えめ
- ✅ アイコンとテキストを組み合わせた直感的なUI
- ✅ カード型レイアウトで情報を整理

### フォント
- **見出し**: font-bold, text-2xl ~ text-4xl
- **本文**: font-normal, text-base
- **小見出し**: font-semibold, text-lg
- **キャプション**: text-sm, text-gray-500

### コンポーネント方針
- **ボタン**: 角丸（rounded-lg）、ホバーエフェクト
- **入力フォーム**: ボーダー控えめ、フォーカス時にプライマリーカラー
- **カード**: 白背景、薄いシャドウ、角丸
- **ナビゲーション**: サイドバー（管理画面）、ヘッダー（ユーザー画面）

---

## 🗂️ コンポーネント設計

### 共通コンポーネント
- [ ] Header（ヘッダーナビゲーション）
- [ ] Footer
- [ ] Button（Primary/Secondary/Outline）
- [ ] Input（テキスト/メール/パスワード/日付/時間）
- [ ] Select（ドロップダウン）
- [ ] Card
- [ ] Modal（ダイアログ）
- [ ] Toast（通知）
- [ ] Loading（ローディングスピナー）
- [ ] Calendar（カレンダーUI）
- [ ] Sidebar（管理画面用）

### ページ固有コンポーネント
- [ ] ReservationCard（予約カード）
- [ ] MenuCard（メニューカード）
- [ ] StaffCard（スタッフカード）
- [ ] CustomerCard（顧客カード）
- [ ] TimeSlotPicker（時間帯選択）
- [ ] ReservationCalendar（予約カレンダー）
- [ ] DashboardStats（統計カード）
- [ ] ReservationTimeline（予約タイムライン）

---

## 📊 データフロー

### ユーザー予約フロー
```
トップページ
  ↓
ログイン/新規登録
  ↓
予約カレンダー（空き状況確認）
  ↓
メニュー選択
  ↓
スタッフ選択
  ↓
日時選択
  ↓
予約確認
  ↓
予約完了（メール送信）
```

### 管理者予約管理フロー
```
管理者ログイン
  ↓
ダッシュボード
  ↓
予約管理（カレンダー/一覧）
  ↓
予約詳細・編集
  ↓
顧客情報確認
  ↓
ステータス更新
```

---

## 🚀 実装優先順位

### Sprint 1（基盤構築）
1. Next.jsプロジェクトセットアップ
2. Tailwind CSS + shadcn/ui 設定
3. Supabaseセットアップ
4. 認証機能実装（ユーザー/管理者）
5. 基本レイアウト・共通コンポーネント作成

### Sprint 2（ユーザー機能）
6. トップページ
7. 予約カレンダーUI
8. メニュー選択画面
9. スタッフ選択画面
10. 予約確認・完了画面
11. マイページ

### Sprint 3（管理機能）
12. 管理者ダッシュボード
13. 予約管理（カレンダー/一覧）
14. 顧客管理
15. スタッフ管理
16. メニュー管理
17. 店舗設定

### Sprint 4（拡張機能）
18. メール送信機能
19. リマインダー自動送信
20. 分析レポート
21. クーポン機能

---

## 📝 メモ
- デザインは汎用的にし、美容室・飲食店・歯科医院など多業種に対応できるようにする
- 白ベースで清潔感・信頼感を演出
- スマホファーストで設計（レスポンシブ対応必須）
- アクセシビリティにも配慮（キーボード操作、スクリーンリーダー対応）
